<!doctype html>
<html lang=en>
<head>
<meta charset=UTF-8>
<title>OnlySats Admin</title>
<link rel="icon" href="/img/OnlySats_Logo.svg" type="image/x-icon">
</head>
<body>
<div class=navbar>
<a href=/ >Home</a>
<a href=../gallery>Gallery</a>
<a href=../about>About Station</a>
<a href=login>Log In</a>
<div class=dropdown>
<button class=dropbtn>â˜°</button>
<div class=dropdown-content>
<a class=active href=local/admin>Admin Panel</a>
<a href=satdump>Satdump</a>
<a href=stats>System</a>
</div>
</div>
</div>
<div class="admin-layout">
    <aside class="admin-sidebar">
      <button data-page="general" class="active">General</button>
      <button data-page="net">Network</button>
      <button data-page="storage">Files</button>
      <button data-page="satdump">Satdump</button>
      <button data-page="passes">Passes</button>
      <button data-page="images">Images</button>
      <input type="button"value="Save"onclick="saveSettings();"/>
    </aside>

    <main id="admin-content">
      <div id="admin-page-root"style=margin:10px></div>
<style>
:root {
--bg:oklch(0.15 0.075 301);
--bg-dark:oklch(0.1 0.075 301);
--bg-light:oklch(0.2 0.075 301);
--border:oklch(0.4 0.15 301);
--border-muted:oklch(0.3 0.15 301);
--danger:oklch(0.7 0.15 30);
--highlight:oklch(0.5 0.15 301);
--info:oklch(0.8 0.15 260);
--primary:oklch(0.76 0.15 301);
--secondary:oklch(.65 0.13 240);
--success:oklch(0.7 0.15 160);
--text:oklch(0.96 0.1 301);
--text-muted:oklch(0.76 0.1 301);
--warning:oklch(0.7 0.15 100)
}
body { background-color:var(--bg); font-family:sans-serif; margin:0; padding:0 }
h3 {display:flex;align-items:center;gap:.5rem}
.navbar { background-color:var(--bg-light); overflow:hidden; width:100% }
.navbar a { align-content:center; color:var(--text); float:left; font-size:17px; height:34px;
  overflow:hidden; padding:0; text-align:center; text-decoration:none; width:20% }
.navbar a.active { background-color:var(--bg-dark); color:var(--text-muted) }
@media screen and (max-width: 525px) { 
  .navbar a { display:block; float:none; text-align:left; width:100% }
  .msg__title { padding: 14px 16px 0 14px;}}
#container { display:flex; gap:2rem; padding:1rem }
#admin-center-stats { color:var(--text) }
#text-panel { background:var(--highlight); border:1px solid var(--border-muted); border-radius:.5rem; color:var(--text);
  font-family:monospace; padding:1rem; white-space:pre-wrap; width:60% }
.dropdown { float:right; overflow:hidden }
.dropdown .dropbtn { background-color:inherit; border:none; color:var(--text); font-family:inherit; font-size:16px;
  height:34px; margin:0; outline:none; width:40px }
.navbar a:hover,.dropdown:hover .dropbtn { background-color:var(--highlight) }
.dropdown-content { background-color:var(--bg); box-shadow:0 8px 16px 0 var(--border); display:none; position:absolute; right:6px; width:100px; z-index:1 }
.dropdown-content a { background-color:var(--bg-light); color:var(--text); display:block; float:left; padding-right:6px;
  text-align:right; text-decoration:none; width:100% }
.dropdown-content a:hover { background-color:var(--highlight); border-width:1px }
.dropdown:hover .dropdown-content { display:block }
.hidden {display:none;}
hr{display:block;margin-block-start:0.5em;margin-block-end:0.5em;margin-inline-start:auto;margin-inline-end:auto;border:var(--border);unicode-bidi: isolate;
  overflow:hidden;border-style:inset;border-width:1px;margin:20px;}
.info{cursor:help;color:var(--text-muted);border:1px solid var(--border);border-radius:50%;width:1.1em;height:1.1em;display:inline-flex;align-items:center;justify-content:center;font-size:.85em;user-select:none}
.card{color:var(--text)}
.admin-layout {display:grid;grid-template-columns:minmax(100px, 17%) minmax(0px, calc(100% - 17%));height:calc(100vh - 34px);}
.admin-sidebar{background:var(--bg-dark);color:var(--text-muted);padding:12px;border-right:1px solid var(--border-muted);}
.admin-sidebar button{background:none;border:none;padding:12px 10px;text-align:center;border-radius:12px;cursor:pointer;width:100%;color:var(--text);margin-top:6px;font-size:16px;}
.admin-sidebar button.active, .admin-sidebar button:hover{background:var(--bg-light);color:var(--text);font-weight:700;}
.admin-sidebar input{color:var(--text);background:var(--bg-light);border:none;border-radius:12px;width:100%;padding:16px 12px;margin-top:6px;cursor:pointer}
.admin-sidebar input:hover{background:var(--highlight);color:var(--text);font-size:20px;}
.setting-card {border-radius:10px;width:46%;max-width:250px;margin:min(2%, 14px);aspect-ratio:1;background:var(--bg-light);}
.setting-button {color:var(--text);background:var(--bg-light);border:none;border-radius:16px;width:100%;height:20%;}
.setting-toggle{color:var(--text);display:block;height:100%;text-align:center;}
.setting-toggle input:checked + svg {stroke:var(--success);}
.setting-row{height:86px;width:100%;align-items:center;display:grid;grid-template-columns:86px 100px calc(100% - 236px) minmax(0px, 20px)}
.setting-dropdown{color:var(--text); height: 35%; background-color: var(--bg-dark); border: var(--border) solid 2px; margin-left: 12px; border-radius: 10px;}
.setting-dropdown > option {border: none;}
.setting-field{color:var(--text-muted);max-width:900px;border:var(--border) solid; background:var(--bg-dark)}
</style>
</div>
</main>
<script>
const root = document.getElementById('admin-page-root');
const buttons = document.querySelectorAll('.admin-sidebar button');
const loadedScripts = new Set();

async function loadPage(name) {
  buttons.forEach(b =>
    b.classList.toggle('active', b.dataset.page === name)
  );

  const res = await fetch(`admin/${name}`);
  root.innerHTML = await res.text();

  root.querySelectorAll("script").forEach(old => {
    const s = document.createElement("script");
    s.textContent = old.textContent;
    old.replaceWith(s);
  });

  const fn = window[`admin_${name}Init`];
  if (typeof fn === "function") {
    fn();
  }
}

buttons.forEach(btn => {
  btn.addEventListener('click', () => {
    loadPage(btn.dataset.page);
  });
});

function escapeHtml(s) {
  return String(s ?? '').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
}

// default page
loadPage('general');

function clearMsg(){ cmsg.textContent=''; cmsg.classList.remove('comp-ok','comp-bad'); }
</script>
</body>
</html>